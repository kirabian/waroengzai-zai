<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waroeng Zai Zai - Roleplay Shop</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --pink: #FFE9F3;
            --white: #fff;
            --text: #5E4B56;
            --accent: #E0A5C0;
            --accent-strong: #c45b8a;
            --shadow: rgba(224, 165, 192, 0.15);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--pink) 0%, #fff 100%);
            color: var(--text);
            min-height: 100vh;
        }

        header {
            text-align: center;
            padding: 2.5rem 1rem;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid var(--accent);
            box-shadow: 0 4px 15px var(--shadow);
        }

        h1 {
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            color: var(--text);
            margin-bottom: 0.5rem;
        }

        .tagline {
            color: var(--accent-strong);
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .catalog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .catalog-item {
            background: #fff;
            border: 1px solid #f5d6e0;
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: 0 5px 20px var(--shadow);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .catalog-item:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 30px rgba(224, 165, 192, 0.25);
        }

        .catalog-item h3 {
            color: var(--accent-strong);
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
        }

        .price {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--text);
            margin-bottom: 1rem;
        }

        .quantity-control {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .quantity-control label {
            font-size: 0.9rem;
            color: var(--text);
        }

        input[type="number"] {
            width: 60px;
            text-align: center;
            border-radius: 10px;
            border: 2px solid #f5d6e0;
            padding: 0.5rem;
            font-size: 1rem;
            transition: border 0.3s;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: var(--accent);
        }

        .add-to-cart {
            margin-top: auto;
            background: linear-gradient(135deg, var(--accent), var(--accent-strong));
            border: none;
            padding: 0.8rem 1.2rem;
            color: #fff;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 1rem;
        }

        .add-to-cart:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(196, 91, 138, 0.3);
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .pagination button {
            padding: 0.6rem 1rem;
            border: none;
            background: var(--accent);
            color: #fff;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            min-width: 40px;
        }

        .pagination button:hover {
            background: var(--accent-strong);
            transform: scale(1.1);
        }

        .pagination button.active {
            background: var(--accent-strong);
            box-shadow: 0 4px 10px rgba(196, 91, 138, 0.3);
        }

        .cart-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: linear-gradient(135deg, var(--accent-strong), var(--accent));
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 70px;
            height: 70px;
            font-size: 1.8rem;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(196, 91, 138, 0.4);
            transition: all 0.3s ease;
            z-index: 100;
        }

        .cart-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(196, 91, 138, 0.5);
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff6584;
            color: #fff;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 999;
            overflow-y: auto;
            padding: 1rem;
        }

        .modal.open {
            display: flex;
            align-items: flex-start;
            justify-content: center;
        }

        .modal-content {
            background: #fff;
            width: 100%;
            max-width: 500px;
            margin: 2rem auto;
            padding: 2rem;
            border-radius: 20px;
            border: 1px solid #f5d6e0;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 2rem;
            color: var(--accent-strong);
            cursor: pointer;
            transition: transform 0.3s;
        }

        .close-btn:hover {
            transform: rotate(90deg);
        }

        .modal h2 {
            color: var(--accent-strong);
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            margin-bottom: 0.8rem;
            background: #fff8fb;
            border-radius: 12px;
            border: 1px solid #f5d6e0;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-info b {
            color: var(--accent-strong);
            display: block;
            margin-bottom: 0.3rem;
        }

        .remove-btn {
            background: #ff99b9;
            border: none;
            color: #fff;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .remove-btn:hover {
            background: #ff6584;
            transform: scale(1.05);
        }

        #totalPrice {
            text-align: right;
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--accent-strong);
            margin: 1.5rem 0;
            padding: 1rem;
            background: #fff8fb;
            border-radius: 12px;
        }

        #paymentSection h3 {
            color: var(--accent-strong);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .payment-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 0.8rem;
            margin: 1rem 0 1.5rem;
        }

        .payment-btn {
            background: #fff;
            border: 2px solid #f5d6e0;
            border-radius: 12px;
            padding: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            color: var(--text);
        }

        .payment-btn.selected,
        .payment-btn:hover {
            background: linear-gradient(135deg, var(--accent), var(--accent-strong));
            color: #fff;
            border-color: var(--accent-strong);
            transform: scale(1.05);
        }

        .testimoni-section {
            max-width: 1200px;
            margin: 3rem auto;
            padding: 2rem 1rem;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 5px 20px var(--shadow);
        }

        .testimoni-section h2 {
            text-align: center;
            color: var(--accent-strong);
            margin-bottom: 1.5rem;
            font-size: 2rem;
        }

        .testimoni-form {
            max-width: 600px;
            margin: 0 auto 2rem;
        }

        .testimoni-section input,
        .testimoni-section textarea {
            width: 100%;
            padding: 0.8rem;
            border-radius: 12px;
            border: 2px solid #f5d6e0;
            margin-bottom: 0.8rem;
            font-family: inherit;
            font-size: 1rem;
            transition: border 0.3s;
        }

        .testimoni-section input:focus,
        .testimoni-section textarea:focus {
            outline: none;
            border-color: var(--accent);
        }

        .testimoni-section textarea {
            resize: vertical;
            min-height: 100px;
        }

        .button-group {
            display: flex;
            gap: 0.8rem;
            flex-wrap: wrap;
        }

        .testimoni-section button {
            flex: 1;
            min-width: 150px;
            padding: 0.8rem 1.5rem;
            background: linear-gradient(135deg, var(--accent), var(--accent-strong));
            color: #fff;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .testimoni-section button:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(196, 91, 138, 0.3);
        }

        .testimoni-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .testimoni {
            background: #fff;
            border: 1px solid #f5d6e0;
            border-radius: 15px;
            padding: 1.2rem;
            box-shadow: 0 3px 15px var(--shadow);
            transition: transform 0.3s;
        }

        .testimoni:hover {
            transform: translateY(-5px);
        }

        .testimoni strong {
            color: var(--accent-strong);
            display: block;
            margin-top: 0.5rem;
        }

        .loading {
            color: var(--accent-strong);
            text-align: center;
            font-style: italic;
            animation: blink 1s infinite;
            padding: 2rem;
        }

        @keyframes blink {
            50% {
                opacity: 0.5;
            }
        }

        footer {
            text-align: center;
            padding: 2rem 1rem;
            font-size: 0.9rem;
            color: #777;
            border-top: 2px solid #f5d6e0;
            background: rgba(255, 255, 255, 0.6);
            margin-top: 3rem;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--accent-strong);
        }

        .empty-state::before {
            content: '🥺';
            font-size: 3rem;
            display: block;
            margin-bottom: 1rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .catalog-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 1rem;
            }

            .cart-btn {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
                bottom: 1rem;
                right: 1rem;
            }

            .modal-content {
                padding: 1.5rem;
                margin: 1rem;
            }

            .testimoni-grid {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
            }

            .testimoni-section button {
                min-width: 100%;
            }
        }

        @media (max-width: 480px) {
            .catalog-grid {
                grid-template-columns: 1fr;
            }

            .payment-methods {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>

<body>

    <header>
        <h1>🌸 Waroeng Zai Zai 🌸</h1>
        <p class="tagline">your fav roleplay shop ✨💕</p>
    </header>

    <div class="container">
        <div class="catalog-grid" id="catalogGrid"></div>
        <div class="pagination" id="pagination"></div>
    </div>

    <button class="cart-btn" onclick="openCart()">🛍️<span class="cart-count" id="cartCount">0</span></button>

    <div class="modal" id="cartModal" onclick="clickOutside(event)">
        <div class="modal-content">
            <button class="close-btn" onclick="closeCart()">&times;</button>
            <h2>Keranjang 💕</h2>
            <div id="cartItems"></div>
            <div id="totalPrice">Total: Rp 0</div>

            <div id="paymentSection" style="display:none;">
                <h3>Pilih Pembayaran:</h3>
                <div class="payment-methods">
                    <button class="payment-btn" onclick="selectPayment('GoPay',event)">GoPay</button>
                    <button class="payment-btn" onclick="selectPayment('DANA',event)">DANA</button>
                    <button class="payment-btn" onclick="selectPayment('QRIS',event)">QRIS</button>
                    <button class="payment-btn" onclick="selectPayment('ShopeePay',event)">ShopeePay</button>
                </div>
                <button class="add-to-cart" id="checkoutBtn" onclick="checkout()" disabled>Checkout ke Telegram
                    💌</button>
            </div>
        </div>
    </div>

    <section class="testimoni-section">
        <h2>Testimoni Pelanggan 💬</h2>
        <div class="testimoni-form">
            <input type="text" id="nama" placeholder="Nama kamu">
            <textarea id="pesan" placeholder="Tulis testimoni kamu disini..."></textarea>
            <div class="button-group">
                <button onclick="kirimTestimoni()">Kirim Testimoni</button>
                <button onclick="downloadExcel()">Download Excel</button>
            </div>
        </div>
        <div class="testimoni-grid" id="testimoniGrid"></div>
    </section>

    <footer>
        🌸 Waroeng Zai Zai © 2025 | Dibuat dengan cinta 💕<br>
        <div style="margin-top: 0.5rem; font-size: 0.85rem;">
            Developed by <a href="https://www.instagram.com/fabiansolutions.id" target="_blank" style="color: var(--accent-strong); text-decoration: none; font-weight: 600;">Tim Fabian Solutions</a>
        </div>
    </footer>

    <script>
        const catalog = [
            { name: 'Manips', price: 4500, id: 1 },
            { name: 'Manips Deco', price: 5500, id: 2 },
            { name: 'MB Basic', price: 600, unit: '/slide', id: 3 },
            { name: 'MB Semi Deco', price: 800, unit: '/slide', id: 4 },
            { name: 'MB Deco', price: 2500, unit: '/slide', id: 5 },
            { name: 'MB Design', price: 3500, unit: '/slide', id: 6 },
            { name: 'Loveboard', price: 3000, unit: '/slide', id: 7 },
            { name: 'Icons', price: 2500, id: 8 },
            { name: 'Scribble', price: '1.5k-3.5k', id: 9 },
            { name: 'Kissedby', price: 1500, unit: '/slide', id: 10 },
            { name: 'Yearbook', price: 800, unit: '/orang', id: 11 },
            { name: 'Wording', price: '1k-15k', id: 12 }
        ];

        const itemsPerPage = 6;
        let currentPage = 1;

        function renderCatalog() {
            const grid = document.getElementById('catalogGrid');
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const items = catalog.slice(start, end);
            grid.innerHTML = items.map(i => `
    <div class="catalog-item">
      <h3>${i.name}</h3>
      <p class="price">${typeof i.price === 'number' ? `Rp ${i.price.toLocaleString('id-ID')}` : i.price}${i.unit || ''}</p>
      <div class="quantity-control">
        <label>Jumlah:</label>
        <input type="number" min="1" value="1" id="qty-${i.id}">
      </div>
      <button class="add-to-cart" onclick="addToCart(${i.id},event)">Tambah ke Keranjang 🛍️</button>
    </div>
  `).join('');
            renderPagination();
        }

        function renderPagination() {
            const totalPages = Math.ceil(catalog.length / itemsPerPage);
            const pagination = document.getElementById('pagination');
            pagination.innerHTML = '';
            for (let i = 1; i <= totalPages; i++) {
                const btn = document.createElement('button');
                btn.textContent = i;
                btn.classList.toggle('active', i === currentPage);
                btn.onclick = () => { currentPage = i; renderCatalog(); };
                pagination.appendChild(btn);
            }
        }

        let cart = [], selectedPayment = '';

        function addToCart(id, e) {
            const it = catalog.find(i => i.id === id);
            const q = parseInt(document.getElementById(`qty-${id}`).value) || 1;
            const ex = cart.find(i => i.id === id);
            if (ex) ex.quantity += q; else cart.push({ ...it, quantity: q });
            updateCartCount();
            e.target.textContent = '✓ Ditambahkan!';
            setTimeout(() => e.target.textContent = 'Tambah ke Keranjang 🛍️', 1000);
        }

        function updateCartCount() {
            document.getElementById('cartCount').textContent = cart.reduce((s, i) => s + i.quantity, 0);
        }

        function openCart() {
            renderCart();
            document.getElementById('cartModal').classList.add('open');
            document.body.style.overflow = 'hidden';
        }

        function closeCart() {
            document.getElementById('cartModal').classList.remove('open');
            document.body.style.overflow = '';
        }

        function clickOutside(e) {
            if (e.target.id === 'cartModal') closeCart();
        }

        function renderCart() {
            const c = document.getElementById('cartItems');
            const pay = document.getElementById('paymentSection');
            if (cart.length === 0) {
                c.innerHTML = '<div class="empty-state">Keranjang masih kosong</div>';
                document.getElementById('totalPrice').textContent = 'Total: Rp 0';
                pay.style.display = 'none';
                return;
            }
            pay.style.display = 'block';
            c.innerHTML = cart.map((i, x) => `
      <div class="cart-item">
        <div class="cart-item-info">
          <b>${i.name}</b>
          <div>${i.quantity}x Rp ${typeof i.price === 'number' ? i.price.toLocaleString('id-ID') : i.price}</div>
        </div>
        <button class="remove-btn" onclick="removeFromCart(${x})">Hapus</button>
      </div>
    `).join('');
            const total = cart.reduce((s, i) => s + (typeof i.price === 'number' ? i.price * i.quantity : 0), 0);
            document.getElementById('totalPrice').textContent = `Total: Rp ${total.toLocaleString('id-ID')}`;
        }

        function removeFromCart(i) {
            cart.splice(i, 1);
            updateCartCount();
            renderCart();
        }

        function selectPayment(m, e) {
            selectedPayment = m;
            document.querySelectorAll('.payment-btn').forEach(b => b.classList.remove('selected'));
            e.currentTarget.classList.add('selected');
            document.getElementById('checkoutBtn').disabled = false;
        }

        function checkout() {
            if (!cart.length) return alert('Keranjang kosong!');
            if (!selectedPayment) return alert('Pilih metode pembayaran dulu!');
            const t = cart.reduce((s, i) => s + (typeof i.price === 'number' ? i.price * i.quantity : 0), 0);
            const list = cart.map(i => `${i.name} (${i.quantity}x) - Rp ${typeof i.price === 'number' ? (i.price * i.quantity).toLocaleString('id-ID') : i.price}`).join('%0A');
            window.open(`https://t.me/kimhwaerin?text=Halo kak!🌸 Mau order:%0A%0A${list}%0A%0ATotal: Rp ${t.toLocaleString('id-ID')}%0APembayaran: ${selectedPayment}`, '_blank');
            cart = [];
            selectedPayment = '';
            updateCartCount();
            closeCart();
        }

        renderCatalog();

        const API_URL = 'https://script.google.com/macros/s/AKfycbz1LJzAnrwoyMgm5uO3kIEC8SVjEm5EzMbsikdVDHh1SnOmUPIq8F9w4rbjTWzvPdw/exec';

        async function fetchTestimoni() {
            const g = document.getElementById('testimoniGrid');
            g.innerHTML = '<p class="loading">Memuat testimoni...</p>';
            try {
                const r = await fetch(API_URL);
                const d = await r.json();
                renderTestimoni(d);
            } catch {
                g.innerHTML = '<p style="text-align:center;color:red;">Gagal memuat testimoni 😢</p>';
            }
        }

        function renderTestimoni(d) {
            const g = document.getElementById('testimoniGrid');
            if (!d.length) return g.innerHTML = '<p style="text-align:center;">Belum ada testimoni</p>';
            g.innerHTML = d.map(t => `<div class="testimoni">"${t.pesan}"<strong>- ${t.nama}</strong></div>`).join('');
        }

        async function kirimTestimoni() {
            const n = document.getElementById('nama').value.trim();
            const p = document.getElementById('pesan').value.trim();
            if (!n || !p) return alert('Isi nama & pesan dulu ya!');
            document.getElementById('testimoniGrid').innerHTML = '<p class="loading">Mengirim testimoni...</p>';
            try {
                await fetch(API_URL, { method: 'POST', body: JSON.stringify({ nama: n, pesan: p }) });
                document.getElementById('nama').value = '';
                document.getElementById('pesan').value = '';
                fetchTestimoni();
                alert('Testimoni berhasil dikirim! 🌸');
            } catch {
                alert('Gagal mengirim testimoni 😢');
                fetchTestimoni();
            }
        }

        async function downloadExcel() {
            try {
                const r = await fetch(API_URL);
                const d = await r.json();
                if (!d.length) return alert('Belum ada data testimoni!');
                const ws = XLSX.utils.json_to_sheet(d);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'Testimoni');
                XLSX.writeFile(wb, 'testimoni_waroeng_zai_zai.xlsx');
            } catch {
                alert('Gagal mendownload data 😢');
            }
        }

        fetchTestimoni();
    </script>
</body>

</html>